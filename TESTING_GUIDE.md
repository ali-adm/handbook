# Руководство по тестированию исправлений

## Исправленные проблемы:

### 1. **Регистронезависимый поиск**
- **Проблема**: Поиск "медведев" не находил "Медведев"
- **Решение**: Расширен поиск на все поля сотрудника с использованием `ilike()`
- **Тестирование**: 
  - Введите "медведев" в поле поиска (в нижнем регистре)
  - Должны найтись записи с "Медведев" (в верхнем регистре)
  - Поиск работает по всем полям: ФИО, отдел, должность, телефоны, email

### 2. **Экспорт в PDF**
- **Проблема**: Кнопка "Экспорт PDF" не работала, ошибка 500 на сервере
- **Решение**: 
  - Упрощена функция экспорта (убраны сложные шрифты)
  - Добавлены шрифты в Dockerfile
  - Улучшена обработка ошибок
- **Тестирование**:
  - Нажмите кнопку "Экспорт PDF"
  - Должен скачаться файл `phone_directory.pdf`
  - Проверьте, что кириллица отображается корректно
  - Таблица должна помещаться на странице

## Команды для обновления на сервере:

```bash
# Подключиться к серверу
ssh admin_d@192.168.7.51

# Перейти в директорию проекта
cd /path/to/handbook

# Обновить код из репозитория
git pull

# Пересобрать и запустить контейнеры
docker compose down
docker compose up --build
```

## Что проверять после обновления:

1. **Поиск**: 
   - Введите "медведев" (в нижнем регистре) - должен найти "Медведев"
   - Введите "иванов" - должен найти "Иванов Иван Иванович"

2. **Экспорт PDF**:
   - Нажмите кнопку "Экспорт PDF"
   - Должен скачаться PDF файл
   - Проверьте, что все данные отображаются корректно
   - Кириллица должна отображаться без квадратиков

3. **Общая функциональность**:
   - Импорт из Excel/CSV
   - Редактирование сотрудников
   - Удаление сотрудников
   - Загрузка фото

## Если проблемы сохраняются:

1. **Проверьте логи**:
   ```bash
   docker compose logs backend
   ```

2. **Проверьте версии библиотек**:
   ```bash
   docker compose exec backend pip list | grep -E "(pandas|numpy|reportlab)"
   ```

3. **Проверьте шрифты**:
   ```bash
   docker compose exec backend ls -la /usr/share/fonts/truetype/
   ```

## Ожидаемый результат:

- ✅ Поиск работает независимо от регистра
- ✅ Экспорт PDF работает корректно
- ✅ Кириллица отображается правильно
- ✅ Все CRUD операции функционируют
- ✅ Приложение готово к использованию
