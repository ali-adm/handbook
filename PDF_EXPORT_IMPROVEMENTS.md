# Улучшения экспорта в PDF

## Решенные проблемы:

### 1. **Кириллица отображается квадратиками**
- **Решение**: Добавлена поддержка кириллических шрифтов через `pdfmetrics.registerFont()`
- **Механизм**: Автоматический поиск системных шрифтов с поддержкой кириллицы (Arial, Times New Roman, DejaVu Sans, Liberation Sans)
- **Резерв**: Если шрифты не найдены, используется Helvetica

### 2. **Внутренние номера не отображаются**
- **Решение**: Улучшена обработка пустых значений и форматирование данных
- **Механизм**: Все поля теперь гарантированно обрабатываются как строки с проверкой на None

### 3. **Таблица вылезает за пределы листа**
- **Решение**: 
  - Использована альбомная ориентация страницы (`landscape(A4)`)
  - Оптимизированы ширины колонок: [80, 120, 100, 50, 60, 60, 100] пунктов
  - Добавлены отступы по краям страницы

## Визуальные улучшения:

### 1. **Профессиональный дизайн**
- **Заголовок таблицы**: Синий фон с белым текстом (#2E86AB)
- **Чередование строк**: Белый и светло-серый фон для лучшей читаемости
- **Границы**: Тонкие серые линии между ячейками

### 2. **Улучшенная типографика**
- **Шрифты**: Кириллические шрифты для всего документа
- **Размеры**: 
  - Заголовок: 16pt
  - Заголовки таблицы: 9pt
  - Данные: 8pt
- **Выравнивание**: Все данные выровнены по левому краю

### 3. **Дополнительные элементы**
- **Повторение заголовков**: Заголовки таблицы повторяются на каждой странице
- **Счетчик записей**: Внизу документа отображается общее количество записей
- **Отступы**: Оптимизированные отступы для лучшего восприятия

## Технические особенности:

- **Автоматическое определение шрифтов**: Работает на Windows и Linux
- **Обработка ошибок**: Грамотная обработка исключений при генерации PDF
- **Оптимизация памяти**: Использование BytesIO для работы в памяти
- **Многостраничность**: Поддержка больших таблиц с автоматическим разбиением на страницы

## Результат:

Теперь PDF-экспорт:
- ✅ Корректно отображает кириллицу
- ✅ Показывает все номера телефонов
- ✅ Умещается на странице
- ✅ Имеет профессиональный внешний вид
- ✅ Легко читается
